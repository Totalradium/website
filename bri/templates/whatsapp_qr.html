<!DOCTYPE html>
<html>
<head>
    <title>WhatsApp QR Code</title>
    <meta http-equiv="refresh" content="5">
    <style>
        body { text-align: center; font-family: Arial; padding: 50px; }
        .qr-container { margin: 20px auto; }
        .status { font-size: 18px; margin: 20px; }
        .connected { color: green; }
        .connecting { color: orange; }
    </style>
</head>
<body>
    <h1>WhatsApp Authentication</h1>
    <div id="status" class="status connecting">Checking connection...</div>
    <div id="qr-container" class="qr-container"></div>
    
    <script>
        async function checkStatus() {
            try {
                const response = await fetch('/whatsapp/qr/', {
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                const data = await response.json();
                
                if (data.status === 'connected') {
                    document.getElementById('status').innerHTML = '‚úÖ WhatsApp Connected!';
                    document.getElementById('status').className = 'status connected';
                    document.getElementById('qr-container').innerHTML = '';
                } else if (data.qr || data.status === 'qr_ready') {
                    document.getElementById('status').innerHTML = 'üì± Scan QR Code with WhatsApp';
                    document.getElementById('qr-container').innerHTML = `<img src="${data.qr}" alt="QR Code" style="max-width: 300px;">`;
                } else if (data.status === 'connecting') {
                    document.getElementById('status').innerHTML = 'üîÑ Generating QR Code...';
                    document.getElementById('qr-container').innerHTML = '';
                } else {
                    document.getElementById('status').innerHTML = 'üîÑ Connecting to WhatsApp...';
                    document.getElementById('qr-container').innerHTML = '';
                }
            } catch (error) {
                document.getElementById('status').innerHTML = '‚ùå WhatsApp service not running';
            }
        }
        
        checkStatus();
        setInterval(checkStatus, 3000);
    </script>
</body>
</html>